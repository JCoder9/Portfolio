<div class="project-detail" *ngIf="project">
  <div class="project-header">
    <button class="back-button" (click)="goBack()">← Back to Projects</button>
    <div class="project-hero">
      <div class="project-images" *ngIf="project.images && project.images.length > 0">
        <img [src]="project.images[0]" [alt]="project.title" class="hero-image">
      </div>
      <div class="project-info">
        <h1>{{ project.title }}</h1>
        <div class="project-category" *ngIf="project.category">
          <span class="category-badge">{{ project.category.name }}</span>
        </div>
        <p class="project-description">{{ project.overview }}</p>
      </div>
    </div>
  </div>

  <div class="project-content">
    <div class="main-content">
      
      <!-- Project Images Gallery -->
      <section class="images-gallery" *ngIf="project.images && project.images.length > 1">
        <h2>Project Gallery</h2>
        <div class="gallery-container">
          <div class="main-image">
            <img [src]="selectedImage" [alt]="project.title" class="featured-image" (click)="openPopup(selectedImage)" />
            <video *ngIf="isVideo(selectedImage)" [src]="selectedImage" controls class="featured-video" (click)="openPopup(selectedImage)"></video>
          </div>
          <div class="image-picker">
            <div class="image-scroll" [style.transform]="'translateX(' + scrollPosition + 'px)'">
              <div 
                *ngFor="let image of project.images; let i = index" 
                class="thumbnail"
                [class.active]="selectedImage === image"
                (click)="selectImage(image)"
              >
                <img [src]="image" [alt]="project.title + ' ' + (i + 1)" class="thumb-image" (click)="openPopup(image); $event.stopPropagation()" />
                <div *ngIf="isVideo(image)" class="video-overlay" (click)="openPopup(image); $event.stopPropagation()">▶</div>
              </div>
            </div>
            <button 
              *ngIf="canScrollLeft" 
              class="scroll-button left" 
              (click)="scrollLeft()"
            >‹</button>
            <button 
              *ngIf="canScrollRight" 
              class="scroll-button right" 
              (click)="scrollRight()"
            >›</button>
          </div>
        </div>
      </section>

      <!-- Project Goals -->
      <section class="goals" *ngIf="project.goals && project.goals.length > 0">
        <h2>Project Goals</h2>
        <ul class="goals-list">
          <li *ngFor="let goal of project.goals">{{ goal }}</li>
        </ul>
      </section>

      <!-- Project Phases -->
      <section class="phases" *ngIf="project.phases && project.phases.length > 0">
        <h2>Development Phases</h2>
        <div class="phases-container">
          <div *ngFor="let phase of project.phases" class="phase-item">
            <h3>{{ phase.name }}</h3>
            <ul class="tasks-list">
              <li *ngFor="let task of phase.tasks">{{ task }}</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Conclusion -->
      <section class="conclusion" *ngIf="project.conclusion">
        <h2>Conclusion</h2>
        <p [innerHTML]="project.conclusion.replace('\\n', '<br>')"></p>
      </section>

      <!-- Project Links -->
      <section class="project-links" *ngIf="project.link">
        <h2>Project Links</h2>
        <div class="links-grid">
          <a 
            [href]="project.link" 
            class="project-link"
            target="_blank"
            rel="noopener"
            *ngIf="project.link"
          >
            View Project
          </a>
        </div>
      </section>
    </div>
  </div>
</div>

<!-- Popup Modal -->
<div class="popup-overlay" *ngIf="showPopup" (click)="onPopupBackdropClick($event)">
  <div class="popup-content">
    <button class="popup-close" (click)="closePopup()">&times;</button>
    <img *ngIf="!isVideo(popupImage)" [src]="popupImage" [alt]="project?.title" class="popup-image" />
    <video *ngIf="isVideo(popupImage)" [src]="popupImage" controls class="popup-video" autoplay></video>
  </div>
</div>

<div class="project-not-found" *ngIf="!project">
  <h1>Project Not Found</h1>
  <p>The requested project could not be found.</p>
  <button class="back-button" (click)="goBack()">← Back to Projects</button>
</div>
